from Crypto.PublicKey import RSA
from time import sleep
import requests
import json

# n = 'be83760b75c7382d205ce14cc9470be4ae6158fabdd8157eeb04d269b4921899f4676e4a61ca34fed12a04a59638daa4069212c3c30b44d50f0557b9d14372174fe6cb5844be6eb2ab39fa7d688002675e486ca763b836be4e515fa43714b3e72edf1093e6826f6550f95300800a4879a698b4cf3f0d549a011d0302fd70858f'
# n = int(n, 16)
# e = 65537

cipher_hex = 'bac936c23a9aeb60b0c1891f3d37511c3fbe9a047a3625fe08c041418f441b59b70d8e91f1c55ce5365ebf4ff5d732f8d4bd06dd4843e1ed27d29d9a9b1df263549cf74528a908452ab1e9f1cc75dcc24755d11f654714a9e0a89c2f2fc20cc7e6494474fdbe0f07b0f2ca90e44fa415d4eb7ed0c842c0a45205051fd3a892a0'
cipher_int = int(cipher_hex, 16)

pub_key_file = '../pub.key'
public_key_data = open(pub_key_file, 'r').read()
public_key = RSA.importKey(public_key_data)
n = public_key.n
e = public_key.e


url = 'http://209.97.138.240:30497/'
headers = {
    'Content-Type' : 'application/json'
}
proxies = {
    'http' : 'http://localhost:8080',
    'https' : 'https://localhost:8080'
}

for c in range(1, 256):

    c_prime = (pow(c, e, n) * cipher_int)%n


    data = {
        'message' : str(hex(c_prime))[2:]
    }

    result = requests.post(url, headers=headers, data=json.dumps(data)).text
    print(f"[+] Result for padding {c}  : {result}")
    # print(pow(c, e, n))
    
    # sleep(3)